# This R script implements hierarchical clustering using pvclust package and compare
# dendrograms using dendextend package. The aim of the clustering is to find natural 
# clusters of forest types based on predictor variables or features derived from 
# 5x5 square image object statistics generated by eCognition. The purpose of comparing
# dendrograms is to assess consistencies in clustering across years and variables by 
# evaluating similarities of dendrograms based on available metrics.
#
# Script By:      Jose Don T. De Alban
# Date Created:   22 Jan 2016
# Last Modified:  03 Mar 2016 

# Load the required R libraries
library(pvclust)
library(dendextend)
library(magrittr)
library(corrplot)
library(ggplot2)

# CASE 1: POLARISATION

# Set working directory
setwd("/Users/dondealban/Image Processing/Thesis/R/3 clustering 2016/")

# Read data, define variables, and store data in variables
raw2007 <- as.matrix(read.csv(file="PALSARwDEM-NLuzon-Clustering-2007-CBS.csv", header=TRUE, sep=",", row.name = 1))
raw2008 <- as.matrix(read.csv(file="PALSARwDEM-NLuzon-Clustering-2008-CBS.csv", header=TRUE, sep=",", row.name = 1))
raw2009 <- as.matrix(read.csv(file="PALSARwDEM-NLuzon-Clustering-2009-CBS.csv", header=TRUE, sep=",", row.name = 1))
raw2010 <- as.matrix(read.csv(file="PALSARwDEM-NLuzon-Clustering-2010-CBS.csv", header=TRUE, sep=",", row.name = 1))

# Normalise variables by rescaling for compatibility of resulting clusters
nlz2007 <- scale(raw2007)
nlz2008 <- scale(raw2008)
nlz2009 <- scale(raw2009)
nlz2010 <- scale(raw2010)

# Subset data by selecting variables
nlz2007c1 <- nlz2007[,c(40:42,48:50)]
nlz2008c1 <- nlz2008[,c(40:42,48:50)]
nlz2009c1 <- nlz2009[,c(40:42,48:50)]
nlz2010c1 <- nlz2010[,c(40:42,48:50)]

# Transpose matrix elements
tnlz2007c1 = t(nlz2007c1)
tnlz2008c1 = t(nlz2008c1)
tnlz2009c1 = t(nlz2009c1)
tnlz2010c1 = t(nlz2010c1)

# Hierarchical clustering using pvclust package
clust.nlz2007c1 <- pvclust(tnlz2007c1, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2008c1 <- pvclust(tnlz2008c1, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2009c1 <- pvclust(tnlz2009c1, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2010c1 <- pvclust(tnlz2010c1, method.hclust="average", method.dist="euclidean", nboot=1000)

# Plot dendrograms and save as PDF file
pdf("output-dendrogram-2007-case1.pdf", width=7, height=5.5)
clust.nlz2007c1 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2007 Case 1")
clust.nlz2007c1 %>% text
clust.nlz2007c1 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2008-case1.pdf", width=7, height=5.5)
clust.nlz2008c1 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2008 Case 1")
clust.nlz2008c1 %>% text
clust.nlz2008c1 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2009-case1.pdf", width=7, height=5.5)
clust.nlz2009c1 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2009 Case 1")
clust.nlz2009c1 %>% text
clust.nlz2009c1 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2010-case1.pdf", width=7, height=5.5)
clust.nlz2010c1 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2010 Case 1")
clust.nlz2010c1 %>% text
clust.nlz2010c1 %>% pvrect(alpha=0.95)
dev.off()

# Convert pvclust object variables to dendextend object variables
dend2007c1 <- as.dendrogram(clust.nlz2007c1)
dend2008c1 <- as.dendrogram(clust.nlz2008c1)
dend2009c1 <- as.dendrogram(clust.nlz2009c1)
dend2010c1 <- as.dendrogram(clust.nlz2010c1)

# Create a dendlist object from several dendrograms
list.dend78910c1 <- dendlist(dend2007c1, dend2008c1, dend2009c1, dend2010c1)

# Perform global comparison of two or more dendrograms to test if they are equal
equal.dend78910c1 <- all.equal(list.dend78910c1)

# Generate correlation matrix between a list of trees
cormat.dend78910c1 <- cor.dendlist(list.dend78910c1)

# Compute Baker's Gamma Index
bg0708c1 <- cor_bakers_gamma(dend2007c1, dend2008c1)
bg0709c1 <- cor_bakers_gamma(dend2007c1, dend2009c1)
bg0710c1 <- cor_bakers_gamma(dend2007c1, dend2010c1)
bg0809c1 <- cor_bakers_gamma(dend2008c1, dend2009c1)
bg0810c1 <- cor_bakers_gamma(dend2008c1, dend2010c1)
bg0910c1 <- cor_bakers_gamma(dend2009c1, dend2010c1)

# Compute Cophenetic Correlation coefficient
cr0708c1 <- cor_cophenetic(dend2007c1, dend2008c1)
cr0709c1 <- cor_cophenetic(dend2007c1, dend2009c1)
cr0710c1 <- cor_cophenetic(dend2007c1, dend2010c1)
cr0809c1 <- cor_cophenetic(dend2008c1, dend2009c1)
cr0810c1 <- cor_cophenetic(dend2008c1, dend2010c1)
cr0910c1 <- cor_cophenetic(dend2009c1, dend2010c1)

# Compute Common Nodes
cn0708c1 <- cor_common_nodes(dend2007c1, dend2008c1)
cn0709c1 <- cor_common_nodes(dend2007c1, dend2009c1)
cn0710c1 <- cor_common_nodes(dend2007c1, dend2010c1)
cn0809c1 <- cor_common_nodes(dend2008c1, dend2009c1)
cn0810c1 <- cor_common_nodes(dend2008c1, dend2010c1)
cn0910c1 <- cor_common_nodes(dend2009c1, dend2010c1)

# Generate summary of dendrogram comparisons and save as TXT file
sink("output-summary-case1.txt", append=FALSE, split=TRUE)
print("DENDLIST OBJECT")
print(list.dend78910c1)
print("GLOBAL COMPARISON OF DENDROGRAMS")
print(equal.dend78910c1)
print("CORRELATION MATRIX BETWEEN TREES")
print(cormat.dend78910c1)
print("BAKER'S GAMMA INDICES")
print(bg0708c1)
print(bg0709c1)
print(bg0710c1)
print(bg0809c1)
print(bg0810c1)
print(bg0910c1)
print("COPHENETIC CORRELATION")
print(cr0708c1)
print(cr0709c1)
print(cr0710c1)
print(cr0809c1)
print(cr0810c1)
print(cr0910c1)
print("COMMON NODES")
print(cn0708c1)
print(cn0709c1)
print(cn0710c1)
print(cn0809c1)
print(cn0810c1)
print(cn0910c1)
sink()

# CASE 2: POLARISATION + TOPOGRAPHIC

# Set working directory
setwd("/Users/dondealban/Image Processing/Thesis/R/3 clustering 2016/")

# Subset data by selecting variables
nlz2007c2 <- nlz2007[,c(40:45,48:53)]
nlz2008c2 <- nlz2008[,c(40:45,48:53)]
nlz2009c2 <- nlz2009[,c(40:45,48:53)]
nlz2010c2 <- nlz2010[,c(40:45,48:53)]

# Transpose matrix elements
tnlz2007c2 = t(nlz2007c2)
tnlz2008c2 = t(nlz2008c2)
tnlz2009c2 = t(nlz2009c2)
tnlz2010c2 = t(nlz2010c2)

# Hierarchical clustering using pvclust package
clust.nlz2007c2 <- pvclust(tnlz2007c2, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2008c2 <- pvclust(tnlz2008c2, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2009c2 <- pvclust(tnlz2009c2, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2010c2 <- pvclust(tnlz2010c2, method.hclust="average", method.dist="euclidean", nboot=1000)

# Plot dendrograms and save as PDF file
pdf("output-dendrogram-2007-case2.pdf", width=7, height=5.5)
clust.nlz2007c2 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2007 Case 2")
clust.nlz2007c2 %>% text
clust.nlz2007c2 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2008-case2.pdf", width=7, height=5.5)
clust.nlz2008c2 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2008 Case 2")
clust.nlz2008c2 %>% text
clust.nlz2008c2 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2009-case2.pdf", width=7, height=5.5)
clust.nlz2009c2 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2009 Case 2")
clust.nlz2009c2 %>% text
clust.nlz2009c2 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2010-case2.pdf", width=7, height=5.5)
clust.nlz2010c2 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2010 Case 2")
clust.nlz2010c2 %>% text
clust.nlz2010c2 %>% pvrect(alpha=0.95)
dev.off()

# Convert pvclust object variables to dendextend object variables
dend2007c2 <- as.dendrogram(clust.nlz2007c2)
dend2008c2 <- as.dendrogram(clust.nlz2008c2)
dend2009c2 <- as.dendrogram(clust.nlz2009c2)
dend2010c2 <- as.dendrogram(clust.nlz2010c2)

# Create a dendlist object from several dendrograms
list.dend78910c2 <- dendlist(dend2007c2, dend2008c2, dend2009c2, dend2010c2)

# Perform global comparison of two or more dendrograms to test if they are equal
equal.dend78910c2 <- all.equal(list.dend78910c2)

# Generate correlation matrix between a list of trees
cormat.dend78910c2 <- cor.dendlist(list.dend78910c2)

# Compute Baker's Gamma Index
bg0708c2 <- cor_bakers_gamma(dend2007c2, dend2008c2)
bg0709c2 <- cor_bakers_gamma(dend2007c2, dend2009c2)
bg0710c2 <- cor_bakers_gamma(dend2007c2, dend2010c2)
bg0809c2 <- cor_bakers_gamma(dend2008c2, dend2009c2)
bg0810c2 <- cor_bakers_gamma(dend2008c2, dend2010c2)
bg0910c2 <- cor_bakers_gamma(dend2009c2, dend2010c2)

# Compute Cophenetic Correlation coefficient
cr0708c2 <- cor_cophenetic(dend2007c2, dend2008c2)
cr0709c2 <- cor_cophenetic(dend2007c2, dend2009c2)
cr0710c2 <- cor_cophenetic(dend2007c2, dend2010c2)
cr0809c2 <- cor_cophenetic(dend2008c2, dend2009c2)
cr0810c2 <- cor_cophenetic(dend2008c2, dend2010c2)
cr0910c2 <- cor_cophenetic(dend2009c2, dend2010c2)

# Compute Common Nodes
cn0708c2 <- cor_common_nodes(dend2007c2, dend2008c2)
cn0709c2 <- cor_common_nodes(dend2007c2, dend2009c2)
cn0710c2 <- cor_common_nodes(dend2007c2, dend2010c2)
cn0809c2 <- cor_common_nodes(dend2008c2, dend2009c2)
cn0810c2 <- cor_common_nodes(dend2008c2, dend2010c2)
cn0910c2 <- cor_common_nodes(dend2009c2, dend2010c2)

# Generate summary of dendrogram comparisons and save as TXT file
sink("output-summary-case2.txt", append=FALSE, split=TRUE)
print("DENDLIST OBJECT")
print(list.dend78910c2)
print("GLOBAL COMPARISON OF DENDROGRAMS")
print(equal.dend78910c2)
print("CORRELATION MATRIX BETWEEN TREES")
print(cormat.dend78910c2)
print("BAKER'S GAMMA INDICES")
print(bg0708c2)
print(bg0709c2)
print(bg0710c2)
print(bg0809c2)
print(bg0810c2)
print(bg0910c2)
print("COPHENETIC CORRELATION")
print(cr0708c2)
print(cr0709c2)
print(cr0710c2)
print(cr0809c2)
print(cr0810c2)
print(cr0910c2)
print("COMMON NODES")
print(cn0708c2)
print(cn0709c2)
print(cn0710c2)
print(cn0809c2)
print(cn0810c2)
print(cn0910c2)
sink()

# CASE 3: POLARISATION + TEXTURE

# Set working directory
setwd("/Users/dondealban/Image Processing/Thesis/R/3 clustering 2016/")

# Subset data by selecting variables
nlz2007c3 <- nlz2007[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:42,48:50)]
nlz2008c3 <- nlz2008[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:42,48:50)]
nlz2009c3 <- nlz2009[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:42,48:50)]
nlz2010c3 <- nlz2010[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:42,48:50)]

# Transpose matrix elements
tnlz2007c3 = t(nlz2007c3)
tnlz2008c3 = t(nlz2008c3)
tnlz2009c3 = t(nlz2009c3)
tnlz2010c3 = t(nlz2010c3)

# Hierarchical clustering using pvclust package
clust.nlz2007c3 <- pvclust(tnlz2007c3, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2008c3 <- pvclust(tnlz2008c3, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2009c3 <- pvclust(tnlz2009c3, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2010c3 <- pvclust(tnlz2010c3, method.hclust="average", method.dist="euclidean", nboot=1000)

# Plot dendrograms and save as PDF file
pdf("output-dendrogram-2007-case3.pdf", width=7, height=5.5)
clust.nlz2007c3 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2007 Case 3")
clust.nlz2007c3 %>% text
clust.nlz2007c3 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2008-case3.pdf", width=7, height=5.5)
clust.nlz2008c3 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2008 Case 3")
clust.nlz2008c3 %>% text
clust.nlz2008c3 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2009-case3.pdf", width=7, height=5.5)
clust.nlz2009c3 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2009 Case 3")
clust.nlz2009c3 %>% text
clust.nlz2009c3 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2010-case3.pdf", width=7, height=5.5)
clust.nlz2010c3 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2010 Case 3")
clust.nlz2010c3 %>% text
clust.nlz2010c3 %>% pvrect(alpha=0.95)
dev.off()

# Convert pvclust object variables to dendextend object variables
dend2007c3 <- as.dendrogram(clust.nlz2007c3)
dend2008c3 <- as.dendrogram(clust.nlz2008c3)
dend2009c3 <- as.dendrogram(clust.nlz2009c3)
dend2010c3 <- as.dendrogram(clust.nlz2010c3)

# Create a dendlist object from several dendrograms
list.dend78910c3 <- dendlist(dend2007c3, dend2008c3, dend2009c3, dend2010c3)

# Perform global comparison of two or more dendrograms to test if they are equal
equal.dend78910c3 <- all.equal(list.dend78910c3)

# Generate correlation matrix between a list of trees
cormat.dend78910c3 <- cor.dendlist(list.dend78910c3)

# Compute Baker's Gamma Index
bg0708c3 <- cor_bakers_gamma(dend2007c3, dend2008c3)
bg0709c3 <- cor_bakers_gamma(dend2007c3, dend2009c3)
bg0710c3 <- cor_bakers_gamma(dend2007c3, dend2010c3)
bg0809c3 <- cor_bakers_gamma(dend2008c3, dend2009c3)
bg0810c3 <- cor_bakers_gamma(dend2008c3, dend2010c3)
bg0910c3 <- cor_bakers_gamma(dend2009c3, dend2010c3)

# Compute Cophenetic Correlation coefficient
cr0708c3 <- cor_cophenetic(dend2007c3, dend2008c3)
cr0709c3 <- cor_cophenetic(dend2007c3, dend2009c3)
cr0710c3 <- cor_cophenetic(dend2007c3, dend2010c3)
cr0809c3 <- cor_cophenetic(dend2008c3, dend2009c3)
cr0810c3 <- cor_cophenetic(dend2008c3, dend2010c3)
cr0910c3 <- cor_cophenetic(dend2009c3, dend2010c3)

# Compute Common Nodes
cn0708c3 <- cor_common_nodes(dend2007c3, dend2008c3)
cn0709c3 <- cor_common_nodes(dend2007c3, dend2009c3)
cn0710c3 <- cor_common_nodes(dend2007c3, dend2010c3)
cn0809c3 <- cor_common_nodes(dend2008c3, dend2009c3)
cn0810c3 <- cor_common_nodes(dend2008c3, dend2010c3)
cn0910c3 <- cor_common_nodes(dend2009c3, dend2010c3)

# Generate summary of dendrogram comparisons and save as TXT file
sink("output-summary-case3.txt", append=FALSE, split=TRUE)
print("DENDLIST OBJECT")
print(list.dend78910c3)
print("GLOBAL COMPARISON OF DENDROGRAMS")
print(equal.dend78910c3)
print("CORRELATION MATRIX BETWEEN TREES")
print(cormat.dend78910c3)
print("BAKER'S GAMMA INDICES")
print(bg0708c3)
print(bg0709c3)
print(bg0710c3)
print(bg0809c3)
print(bg0810c3)
print(bg0910c3)
print("COPHENETIC CORRELATION")
print(cr0708c3)
print(cr0709c3)
print(cr0710c3)
print(cr0809c3)
print(cr0810c3)
print(cr0910c3)
print("COMMON NODES")
print(cn0708c3)
print(cn0709c3)
print(cn0710c3)
print(cn0809c3)
print(cn0810c3)
print(cn0910c3)
sink()

# CASE 4: POLARISATION + TOPOGRAPHIC + TEXTURE

# Set working directory
setwd("/Users/dondealban/Image Processing/Thesis/R/3 clustering 2016/")

# Subset data by selecting variables
nlz2007c4 <- nlz2007[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:45,48:53)]
nlz2008c4 <- nlz2008[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:45,48:53)]
nlz2009c4 <- nlz2009[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:45,48:53)]
nlz2010c4 <- nlz2010[,c(7:9,11:13,15:17,19:21,23:25,27:29,31:33,35:37,40:45,48:53)]

# Transpose matrix elements
tnlz2007c4 = t(nlz2007c4)
tnlz2008c4 = t(nlz2008c4)
tnlz2009c4 = t(nlz2009c4)
tnlz2010c4 = t(nlz2010c4)

# Hierarchical clustering using pvclust package
clust.nlz2007c4 <- pvclust(tnlz2007c4, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2008c4 <- pvclust(tnlz2008c4, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2009c4 <- pvclust(tnlz2009c4, method.hclust="average", method.dist="euclidean", nboot=1000)
clust.nlz2010c4 <- pvclust(tnlz2010c4, method.hclust="average", method.dist="euclidean", nboot=1000)

# Plot dendrograms and save as PDF file
pdf("output-dendrogram-2007-case4.pdf", width=7, height=5.5)
clust.nlz2007c4 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2007 Case 4")
clust.nlz2007c4 %>% text
clust.nlz2007c4 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2008-case4.pdf", width=7, height=5.5)
clust.nlz2008c4 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2008 Case 4")
clust.nlz2008c4 %>% text
clust.nlz2008c4 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2009-case4.pdf", width=7, height=5.5)
clust.nlz2009c4 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2009 Case 4")
clust.nlz2009c4 %>% text
clust.nlz2009c4 %>% pvrect(alpha=0.95)
dev.off()
pdf("output-dendrogram-2010-case4.pdf", width=7, height=5.5)
clust.nlz2010c4 %>% as.dendrogram %>% hang.dendrogram %>% plot(main = "Dendrogram: 2010 Case 4")
clust.nlz2010c4 %>% text
clust.nlz2010c4 %>% pvrect(alpha=0.95)
dev.off()

# Convert pvclust object variables to dendextend object variables
dend2007c4 <- as.dendrogram(clust.nlz2007c4)
dend2008c4 <- as.dendrogram(clust.nlz2008c4)
dend2009c4 <- as.dendrogram(clust.nlz2009c4)
dend2010c4 <- as.dendrogram(clust.nlz2010c4)

# Create a dendlist object from several dendrograms
list.dend78910c4 <- dendlist(dend2007c4, dend2008c4, dend2009c4, dend2010c4)

# Perform global comparison of two or more dendrograms to test if they are equal
equal.dend78910c4 <- all.equal(list.dend78910c4)

# Generate correlation matrix between a list of trees
cormat.dend78910c4 <- cor.dendlist(list.dend78910c4)

# Compute Baker's Gamma Index
bg0708c4 <- cor_bakers_gamma(dend2007c4, dend2008c4)
bg0709c4 <- cor_bakers_gamma(dend2007c4, dend2009c4)
bg0710c4 <- cor_bakers_gamma(dend2007c4, dend2010c4)
bg0809c4 <- cor_bakers_gamma(dend2008c4, dend2009c4)
bg0810c4 <- cor_bakers_gamma(dend2008c4, dend2010c4)
bg0910c4 <- cor_bakers_gamma(dend2009c4, dend2010c4)

# Compute Cophenetic Correlation coefficient
cr0708c4 <- cor_cophenetic(dend2007c4, dend2008c4)
cr0709c4 <- cor_cophenetic(dend2007c4, dend2009c4)
cr0710c4 <- cor_cophenetic(dend2007c4, dend2010c4)
cr0809c4 <- cor_cophenetic(dend2008c4, dend2009c4)
cr0810c4 <- cor_cophenetic(dend2008c4, dend2010c4)
cr0910c4 <- cor_cophenetic(dend2009c4, dend2010c4)

# Compute Common Nodes
cn0708c4 <- cor_common_nodes(dend2007c4, dend2008c4)
cn0709c4 <- cor_common_nodes(dend2007c4, dend2009c4)
cn0710c4 <- cor_common_nodes(dend2007c4, dend2010c4)
cn0809c4 <- cor_common_nodes(dend2008c4, dend2009c4)
cn0810c4 <- cor_common_nodes(dend2008c4, dend2010c4)
cn0910c4 <- cor_common_nodes(dend2009c4, dend2010c4)

# Generate summary of dendrogram comparisons and save as TXT file
sink("output-summary-case4.txt", append=FALSE, split=TRUE)
print("DENDLIST OBJECT")
print(list.dend78910c4)
print("GLOBAL COMPARISON OF DENDROGRAMS")
print(equal.dend78910c4)
print("CORRELATION MATRIX BETWEEN TREES")
print(cormat.dend78910c4)
print("BAKER'S GAMMA INDICES")
print(bg0708c4)
print(bg0709c4)
print(bg0710c4)
print(bg0809c4)
print(bg0810c4)
print(bg0910c4)
print("COPHENETIC CORRELATION")
print(cr0708c4)
print(cr0709c4)
print(cr0710c4)
print(cr0809c4)
print(cr0810c4)
print(cr0910c4)
print("COMMON NODES")
print(cn0708c4)
print(cn0709c4)
print(cn0710c4)
print(cn0809c4)
print(cn0810c4)
print(cn0910c4)
sink()
